@model IEnumerable<RentACar.Models.Car>

@{
    ViewData["Title"] = "Index";
}

<section class="hero-wrap hero-wrap-2 js-fullheight" style="background-image: url('images/18015-MC20BluInfinito-scaled-e1666008987698.jpg');" data-stellar-background-ratio="0.5">
    <div class="overlay"></div>
    <div class="container">
        <div class="row no-gutters slider-text js-fullheight align-items-end justify-content-start">
            <div class="col-md-9 ftco-animate pb-5">
                <p class="breadcrumbs"><span class="mr-2"><a asp-controller="Home" asp-action="Index">Home <i class="ion-ios-arrow-forward"></i></a></span> <span>Cars <i class="ion-ios-arrow-forward"></i></span></p>
                <h1 class="mb-3 bread">Choose Your Car</h1>
            </div>
        </div>
    </div>
</section>


<section class="ftco-section bg-light">
    <form asp-controller="Car" asp-action="Index" class="ftco-animate fadeInUp ftco-animated mb-xl-5" method="get">
        <div class="form-group" style="display: flex; justify-content:center; width:100%; gap: 30px">
            <input type="text" name="searchValue" class="form-control" placeholder="Brand, Model or Description" style="width:20%; display:inline">
            <input type="submit" value="Search" class="btn btn-secondary">
        </div>
    </form>
    <form asp-controller="Car" asp-action="Index" class="ftco-animate fadeInUp ftco-animated mb-xl-5" method="get">
        <div class="form-group" style="display: flex; justify-content:center; width:100%; gap: 30px">
            <select name="categoryId" asp-items="@ViewBag.Categories" style="width: 10%; border-color: gray">
                <option value="">All</option>
            </select>
            <input type="submit" value="Search" class="btn btn-secondary">
        </div>
    </form>
    <form asp-controller="Car" asp-action="Index" class="ftco-animate fadeInUp ftco-animated mb-xl-5" method="get">
        <div class="form-group" style="display: flex; justify-content:center; width:100%; gap: 30px">
            <select name="yearRange" style="width: 10%">
                <option value="">
                    All
                </option>
                <option value="1900-1930">
                    1900-1930
                </option>
                <option value="1930-1960">
                    1930-1960
                </option>
                <option value="1960-1980">
                    1960-1980
                </option>
                <option value="1980-2000">
                    1980-2000
                </option>
                <option value="2000-2010">
                    2000-2010
                </option>
                <option value="2010-+">
                    2010+
                </option>
            </select>
            <input type="submit" value="Search" class="btn btn-secondary">
        </div>
    </form>
    <div class="container">
        <div class="row justify-content-center">
            @if (Model.Any())
            {
                @foreach (var car in Model)
                {
                    var image = car.Images.Last();

                    string imreBase64Data = Convert.ToBase64String(image.Bytes);

                    string imgDataURL = string.Format("data:image/jpg;base64,{0}", imreBase64Data);

                    <div class="col-md-4 mb-5">
                        <a asp-controller="Car" asp-action="Details" asp-route-id="@car.Id">
                            <div class="car-wrap rounded ftco-animate">
                                <img class="img rounded d-flex align-items-end" src=@imgDataURL alt="@car.Brand @car.Model">
                            </div>
                        </a>

                        <div class="text">
                            <h2 class="mb-0">
                                <a asp-controller="Car" asp-action="Details" asp-route-id="@car.Id">
                                    @car.Model @if (car.IsRented)
                                    {
                                        <span>Rented</span>
                                    }
                                </a>
                            </h2>
                            <div class="d-flex mb-3">
                                <span class="cat">@car.Brand</span>
                                <p class="price ml-auto">@car.DailyPrice<span>/day</span></p>
                            </div>
                            <p class="d-flex mb-0 d-block justify-content-center">
                                @if (User.IsInRole("Employee"))
                                {
                                    @if (!car.IsRented)
                                    {
                                        <a asp-area="" asp-controller="Car" asp-action="RentACar" asp-route-id="@car.Id" class="btn btn-primary py-2">Rent</a>
                                        <a asp-area="" asp-controller="Car" asp-action="Edit" asp-route-id="@car.Id" class="btn btn-warning py-2 ml-1">Edit</a>
                                        <a asp-area="" asp-controller="Car" asp-action="Delete" asp-route-id="@car.Id" class="btn btn-danger py-2 ml-1">Delete</a>
                                    }
                                    else
                                    {
                                        <a asp-area="" asp-controller="Car" asp-action="ReturnACar" asp-route-id="@car.Id" class="btn btn-primary py-2">Return</a>
                                    }
                                }
                            </p>
                        </div>
                    </div>
                }
            }
            else
            {
                <p class="d-inline-flex justify-content-center">No records found!</p>
            }


        </div>
        @*<div class="row mt-5">
        <div class="col text-center">
        <div class="block-27">
        <ul>
        <li><a href="#">&lt;</a></li>
        <li class="active"><span>1</span></li>
        <li><a href="#">2</a></li>
        <li><a href="#">3</a></li>
        <li><a href="#">4</a></li>
        <li><a href="#">5</a></li>
        <li><a href="#">&gt;</a></li>
        </ul>
        </div>
        </div>
        </div>*@
    </div>
</section>
